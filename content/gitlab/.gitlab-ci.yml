########################################################################################
# To do
#  Add stage for development and production
# get a sample ansible playbook working
# get a dummy pyats working 
# Create before and after playbooks
# Update for ci to work 
# First task assumed to run within devtools
# Second to run within gitlab.ci 


########################################################################################


---

stages:
  - validate
  - test
  - deploy

########################################################################################
# network_request app jobs
########################################################################################



yamllint:
  stage: validate
  image: registry.gitlab.com/pipeline-components/yamllint:latest
  script:
    - yamllint Ansible


deploy_dev:
  stage: deploy
  script:
    - cd Ansible
    - ansible-playbook -i inventory -e 'devices=development' playbooks/interface_update.yml
  needs: 
    - yamllint
  only:
    - master

deploy_prod:
  stage: deploy
  script:
    - cd Ansible
    - ansible-playbook -i inventory -e 'devices=production' playbooks/interface_update.yml
  needs: 
    - deploy_dev
  only:
    - master
